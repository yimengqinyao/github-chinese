  <script>
    var inputBox = document.getElementById('inputBox');
    var inputBox2 = document.getElementById('inputBox2');
    var timeoutId;
    function startTimer() {
      if (timeoutId) {
        clearTimeout(timeoutId);
      }
      timeoutId = setTimeout(clearInput, 1000);
    }
    inputBox.attachEvent('oninput', startTimer);
    inputBox2.attachEvent('oninput', startTimer);
    function pasteClipboard1() {
      startTimer();
      if (window.clipboardData && window.clipboardData.getData) {
        var clipboardText = window.clipboardData.getData('Text');
        var urlPattern = /^(https?):\/\/[^\s/$.?#].[^\s]*$/i;
        if (urlPattern.test(clipboardText)) {
          inputBox.value = clipboardText;
        } else {
          alert('无效');
        }
      }
    }
    function pasteClipboard2() {
      startTimer();
      if (window.clipboardData && window.clipboardData.getData) {
        var clipboardText = window.clipboardData.getData('Text');
        var urlPattern = /^(https?):\/\/[^\s/$.?#].[^\s]*$/i;
        if (urlPattern.test(clipboardText)) {
          inputBox2.value = clipboardText;
        } else {
          alert('无效');
        }
      }
    }
    function trimString(str) {
      return str.replace(/^\s+|\s+$/g, '');
    }
    function openLink1() {
      startTimer();
      var inputLink = inputBox.value;
      if (inputLink === '') {
        var clipboardText = getClipboardText();
        if (clipboardText) {
          inputLink = clipboardText;
        } else {
          alert('输入');
          return;
        }
      }
      var trimmedInputLink = trimString(inputLink);
      var selectValue = document.getElementById('selectBox').value;
      var id = extractID(trimmedInputLink);
      if (id === '') {
        alert('不符');
        return;
      } else {
        inputBox.value = trimmedInputLink;
      }
      var newLink = 'app=' + selectValue + '&s=' + id;
      var shell = new ActiveXObject("WScript.Shell");
      shell.Run("msedge.exe " + newLink);
    }
    function openLink2() {
      startTimer();
      var inputLink = inputBox.value;
      if (inputLink === '') {
        var clipboardText = getClipboardText();
        if (clipboardText) {
          inputLink = clipboardText;
        } else {
          alert('输入');
          return;
        }
      }
      var trimmedInputLink = trimString(inputLink);
      var id = extractID(trimmedInputLink);
      if (id === '') {
        alert('不符');
        return;
      } else {
        inputBox.value = trimmedInputLink;
      }
      var newLink = 'view/' + id;
      var shell = new ActiveXObject("WScript.Shell");
      shell.Run("msedge.exe " + newLink);
    }
    function openLink3() {
      startTimer();
      var inputLink = inputBox2.value;
      if (inputLink === '') {
        var clipboardText = getClipboardText();
        if (clipboardText) {
          inputLink = clipboardText;
        } else {
          alert('第三方');
          return;
        }
      }
      var trimmedInputLink = trimString(inputLink);
      var id = extractOID(trimmedInputLink);
      if (id === '') {
        alert('链接不符');
        return;
      } else {
        inputBox2.value = trimmedInputLink;
      }
      var newLink = 'id=' + id;
      var shell = new ActiveXObject("WScript.Shell");
      shell.Run("msedge.exe " + newLink);
    }
    function getClipboardText() {
      var clipboardText = '';
      if (window.clipboardData && window.clipboardData.getData) {
        clipboardText = window.clipboardData.getData('Text');
      }
      return clipboardText;
    }
    function extractID(link) {
      var id = '';
      var idPattern = /id=(\d+)/;
      var match = link.match(idPattern);
      if (match && match.length > 1) {
        id = match[1];
      }
      return id;
    }
    function extractOID(link) {
      var id = '';
      var idPattern = /(?:\/view\/|s=)(\d+)/;
      var match = link.match(idPattern);
      if (match && match.length > 1) {
        id = match[1];
      }
      return id;
    }
    function clearInput() {
      inputBox.value = '';
      inputBox2.value = '';
    }
  </script>
